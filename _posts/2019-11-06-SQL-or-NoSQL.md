---
layout: post
title: SQL还是NoSQL
subtitle: 面对海量数据，关系型数据库还能顶得住吗？
date: 2019-11-06
author: aabbcczhy
categories: 数据库
tags: NoSQL 数据库 SQL
---

## 背景

近来阅读《大数据时代》，感慨Google一天要接受大约30亿条的搜索指令（这谁顶得住？）。不仅如此，新浪微博每分钟会产生2万条微博，淘宝每分钟会产生6万个订单（更不用说即将到来的双十一了）。说这些是为了什么呢？试想，一分钟尚且如此，那一天呢？倘若使用关系型数据库，面对上亿条的数据量，即使建立了索引，效率仍然是低下的。因此NoSQL就是这样诞生的。

## What is NoSQL?

NoSQL，比较正确的解释是叫做No Only SQL，不仅仅只是SQL。它是一种不同于关系型数据库的数据库管理系统设计方式，是非关系型数据库的统称。常见的NoSQL的类型有：

1. 键值数据库（Redis、Memcached等）
2. 列族数据库（HBase等）
3. 文档数据库（MongoDB等）
4. 图数据库（Neo4J等）

## 关系型数据库 VS NoSQL

|  比较标准  | 关系型数据库 |               NoSQL                |
| :--------: | :----------: | :--------------------------------: |
| 数据库原理 |   完全支持   |              部分支持              |
|  数据规模  |      大      |               非常大               |
| 数据库模式 |     固定     |                灵活                |
|  查询效率  |      快      | 简单查询十分高效，复杂查询不尽人意 |
|   一致性   |      强      |                 弱                 |
| 数据完整性 |   容易实现   |              很难实现              |
|   扩展性   |     一般     |                 好                 |
|   可用性   |      好      |                很好                |
|   标准化   |      是      |                 否                 |
|  技术支持  |      高      |                 低                 |
|  可维护性  |     复杂     |                复杂                |

由上述表格中，我们不难发现两者其实是有点互补关系的。关系型数据库的优势在于有完善的关系代数理论基础和严格的标准，支持事务的四大特性，可借助索引实现高效查询，技术支持也比较好；劣势在于扩展性，灵活性差，面对海量数据，固定的数据模型无法得到方便的扩展，会显得很死板，事务在Web2.0时代不再显得非常重要。相比之下，NoSQL的优势在于可以支持海量数据的存储，强大的横向扩展能力适应Web2.0的一些需求；其劣势在于缺乏理论基础，复杂查询效率不高，不能实现事务的强一致性，很难实现数据完整性，技术支持较差。

在开发过程中，要根据需求选择数据库。例如，对于银行、超市这类对事务要求比较高的业务还是使用关系型数据库比较好。有时候为了更好地满足需求，也可以采用混合的方式构建数据库应用。

## NoSQL和关系型数据库介绍

### MySQL

MySQL属于关系型数据库管理系统，关系型数据库是将数据库放在不同的表中，而非把所有数据集中存储在一个大仓库内。一般来说，中小型网站的开发都使用MySQL，且MySQL是开源的。

### HBase

HBase是一个分布式的，面向列的开源数据库，它是一个适合于非结构化数据存储的数据库，很大的不同在于HBase是面向列的而不是面向行的模式。HBase强大之处在于它是分布式的，因此它更适合海量数据的处理与存储。

### Redis

Redis是一个高性能的键—值（key-value）存储系统。它支持存储的值的类型很多，小到字符串，大到数据结构（例如：列表、哈希、集合），在开发中经常用来作为缓存数据库。

### MongoDB

MongoDB是一个高性能、易部署、易使用，基于分布式文件存储的数据库，它是一个介于关系数据库和非关系数据库之间的产品，它的数据结构有点类似于JSON对象。MongoDB最大的特点在于它支持的查询语言非常强大，几乎可以实现关系型数据库查询的绝大部分功能，且支持对数据建立索引。

### 四者的区别与应用

首先是关系型数据库MySQL与NoSQL，区别于NoSQL类型的数据库，MySQL优势在于体积小、速度快、成本低、结构稳定，可以保证数据一致性，缺点就是灵活性不够。而NoSQL则是高性能、高扩展、高可用的，但很明显它牺牲了稳定的结构，很难保证数据的一致性。中小型开发一般用MySQL就基本能满足需求了。

那么，另外三款NoSQL数据库如何取舍呢？

概括来说就是：Redis：“**快**”，HBase：“**大**”，MongoDB：“**灵活**”。

因为Redis的“快”，所以Redis特别适合用来做缓存，除此之外，可以用来存放Hadoop或Spark的分析结果。毕竟它这么快，就要发挥它快的优势。

MongoDB关键词是“灵活”，MongoDB的扩展能力很强，这是因为它不需要保证每个列名一致，可以很方便扩充字段。某种程度来说，MongoDB也可以作为主流数据库，当然其稳定程度肯定不如关系型数据库来得好。

最后是HBase，它的关键词是“大”，很显然，它的定位是非结构化大数据，可伸缩性很好，它的最大最大优势在于可以集成hadoop的MapReduce Job，很适合超高量级数据写入的场景。

## 结语

NoSQL数据库较好地满足了Web2.0时代下的存储需求，不管是关系型数据库还是NoSQL，都有各自的优势，不存在谁取代谁的问题，两者会在不同场合满足不同应用的需求。

## 参考文献

[1] 维克托 · 迈尔-舍恩伯格，肯尼思 ·库克那. 大数据时代：生活、工作与思维的大变革. 盛杨燕，等，译. 杭州：浙江人民出版社，2013.

[2] 林子雨. 大数据技术原理与应用：概念、存储、处理、分析与应用 第2版. 北京：人民邮电出版社 2017.1.